# 智能社交学习平台

## 技术架构

### 核心技术栈

- **后端框架**: Spring Boot 3.4.2 + Spring Security + MyBatis
- **数据存储**: MySQL 8.0 + Redis 7.x + Elasticsearch 7.17
- **消息队列**: Apache RocketMQ
- **网络通信**: Netty 4.1 + WebSocket
- **文件存储**: 阿里云 OSS
- **分词搜索**: IK分词器 + HanLP自然语言处理
- **其他组件**: JWT认证、雪花算法、DFA敏感词过滤、分片式布隆过滤器消息去重

### 技术亮点

- **DFA敏感词过滤**: 敏感词过滤算法，时间复杂度O(n)
- **雪花算法**: 分布式ID生成，支持不同业务场景
- **RoaringBitmap**: 高效存储用户关系位图
- **ES智能分词**: HanLP + IK分词器提供中文搜索
- **异步消息处理**: RocketMQ处理耗时操作，提升响应速度

## 功能模块详细梳理

### 1. 用户管理系统

#### 1.1 用户认证与授权

- **用户注册**: 支持邮箱注册，邮箱格式验证，用户名唯一性检查
- **用户登录**: 密码验证，JWT Token生成，多设备登录限制
- **用户登出**: Token失效，安全退出登录
- **权限管理**: 用户权限查询，角色权限控制（普通用户/管理员）
- **IP地理位置**: 基于 GeoIP2实现登录地点IP记录

#### 1.2 用户信息管理

- **个人资料**: 用户信息查看与更新，头像、昵称、个人简介等
- **用户搜索**: 支持按用户名模糊搜索，分页展示
- **用户主页**: 个人主页信息展示，包含IP登录记录

### 2. 社交关系系统

#### 2.1 关注体系

- **关注用户**: 关注/取消关注其他用户，好友关系验证
- **关注列表**: 查看用户关注的人员列表
- **粉丝列表**: 分页查询用户粉丝，支持游标分页优化性能
- **好友系统**: 互相关注形成好友关系，支持好友列表查询

#### 2.2 用户屏蔽

- **用户屏蔽**: 屏蔽指定用户，阻止其互动
- **取消屏蔽**: 移除用户屏蔽状态
- **黑名单管理**: 查看已屏蔽用户列表

### 3. 即时通讯系统

#### 3.1 实时通信

- **WebSocket连接**: 基于Netty的高性能WebSocket服务器
- **消息推送**: 实时双向消息传输，支持文本、图片、文件等多种类型
- **连接管理**: 用户上线/下线状态管理，连接生命周期控制
- **消息去重**: 基于sequenceId和布隆过滤器的消息去重机制，防止重复发送

#### 3.2 会话管理

- **私聊功能**: 一对一私人对话
- **群聊创建**: 支持创建群聊，设置群名称、群头像
- **群成员管理**: 邀请成员入群、踢出成员、解散群聊
- **群权限管理**: 群主、管理员、普通成员权限区分
- **成员禁言**: 群管理员可对成员进行禁言/取消禁言操作

#### 3.3 消息处理

- **消息审核**: 实时敏感词过滤，DFA算法处理
- **消息限流**: 防止用户频繁发送消息，每秒限制1条
- **离线消息**: 用户上线后自动推送离线期间消息和历史消息记录
- **消息状态**: 消息发送确认机制，状态码反馈

### 4. 内容管理系统

#### 4.1 帖子系统

- **帖子发布**: 支持经验分享、问题求助两种类型帖子
- **帖子编辑**: 支持Markdown格式内容编辑
- **帖子管理**: 帖子更新、删除，内容长度限制
- **标签系统**: 帖子标签管理，最多10个标签
- **分页查询**: 支持按类型、用户、时间等维度分页查询，游标分页优化

#### 4.2 视频系统

- **视频上传**: 分段上传支持，大文件断点续传
- **视频管理**: 视频信息编辑，标题、标签、分类、描述等
- **视频审核**: 管理员审核机制，审核状态管理
- **视频查看**: 懒加载设计，点击观看时才加载视频URL
- **视频搜索**: 使用Elastic搜索引擎，支持关键词搜索、时间范围搜索

#### 4.3 评论系统

- **多级评论**: 支持帖子和视频的嵌套评论回复
- **评论管理**: 评论发布、编辑、删除
- **评论点赞**: 评论点赞/取消点赞功能
- **帖子搜索**: 使用Elastic搜索引擎，支持关键词搜索、时间范围搜索

#### 4.4 点赞系统

- **内容点赞**: 支持帖子、视频、评论的点赞功能，redis点赞缓存机制
- **点赞统计**: 实时更新点赞数量统计
- **点赞状态**: 用户点赞状态记录和查询

### 5. 文件管理系统

#### 5.1 文件上传

- **分段上传**: 支持大文件分段上传，断点续传
- **多格式支持**: 视频、图片、文档等多种文件格式
- **上传管理**: 初始化上传、上传进度查询、取消上传

#### 5.2 文件存储

- **云端存储**: 集成阿里云OSS对象存储服务
- **文件分类**: 按类型自动分类存储
- **元数据提取**: 视频时长信息自动提取
- **访问控制**: 文件访问权限控制

#### 5.3 文件检索

- **文件搜索**: 支持按文件名、类型、分类搜索
- **时间范围**: 按上传时间范围查询文件
- **用户文件**: 查询用户个人上传的所有文件

### 6. 学习管理系统

#### 6.1 学习计划

- **计划创建**: 创建个人学习计划，设置标题和目标
- **计划管理**: 学习计划查看、更新、删除
- **计划详情**: 查看计划详细信息和关联任务
- **计划报告**: 学习计划进度报告和统计分析

#### 6.2 学习任务

- **任务创建**: 创建学习任务，支持多种频率（一次性、每日、每周、每月）
- **任务管理**: 任务更新、删除、完成状态管理
- **提醒功能**: 可设置提醒时间，定时提醒学习
- **任务查询**: 按计划查询任务列表，任务详情查看

#### 6.3 学习进度

- **进度追踪**: 自动记录用户学习行为数据
- **内容浏览**: 记录帖子、视频浏览历史
- **学习统计**: 学习总结报告，数据可视化展示
- **全量查询**: 查看所有学习计划和任务概览

### 7. 搜索推荐系统

#### 7.1 全文搜索

- **Elasticsearch集成**: 高性能全文搜索引擎
- **智能分词**: IK分词器 + HanLP自然语言处理
- **多维搜索**: 支持用户、帖子、视频、文件的全文搜索
- **搜索优化**: 建索引用ik_max_word，搜索用ik_smart

#### 7.2 内容推荐

- **个性化推荐**: 基于用户制定的学习计划和内容的推荐机制
- **热门内容**: 按浏览量推荐热门帖子和视频
- **最新内容**: 时间排序的最新内容推荐

#### 7.3 词典管理

- **远程词典**: ES分词器远程词典热更新
- **关键词提取**: HanLP关键词提取和管理
- **词典更新**: 支持动态更新扩展词典

### 8. 内容审核系统

#### 8.1 敏感词过滤

- **DFA算法**: 敏感词检测和替换
- **实时过滤**: 消息发送时实时敏感词过滤
- **词库管理**: 敏感词库动态添加和更新
- **状态持久化**: 敏感词状态转移图序列化存储

#### 8.2 内容审核

- **视频审核**: 管理员视频内容审核流程
- **审核状态**: 待审核、已通过、已拒绝状态管理
- **审核记录**: 审核人员和审核备注记录

### 9. 系统管理功能

#### 9.1 Markdown支持

- **内容渲染**: Markdown格式内容渲染为HTML
- **富文本编辑**: 支持Markdown语法的内容编辑

#### 9.2 推荐定制

- **自定义推荐**: 管理员可配置推荐内容算法

## 创新特色功能

### 1. 高性能架构设计

- **异步消息处理**: 群聊创建等耗时操作使用RocketMQ异步处理
- **分布式ID生成**: 雪花算法保证高并发下的ID唯一性
- **缓存优化**: Redis多层缓存设计，热点数据快速访问

### 2. 用户体验优化

- **游标分页**: 深度分页性能优化，避免大偏移量查询
- **懒加载设计**: 视频URL懒加载，节省带宽
- **断点续传**: 大文件分段上传，网络异常回复后可以继续上传

### 3. 数据存储优化

- **RoaringBitmap**: 用户关系存储优化，极大节省内存
- **位图持久化**: 支持增量序列化，重启快速恢复
- **细粒度锁**: 避免死锁的并发控制设计

### 4. 智能内容处理

- **智能分词**: HanLP + IK分词器提供精准中文搜索
- **关键词提取**: 自动提取内容关键词用于推荐

## 系统性能特点

### 高并发支持

- **Netty网络框架**: 支持万级并发WebSocket连接
- **Redis缓存**: 毫秒级数据访问响应
- **消息队列**: 削峰填谷，处理突发流量

### 数据安全

- **JWT认证**: 无状态安全认证机制
- **权限控制**: 细用户权限管理系统
- **数据加密**: 用户密码加密存储

### 扩展性设计

- **模块化架构**: 各功能模块相对独立，易于扩展
- **容器化部署**: Docker容器化部署支持
